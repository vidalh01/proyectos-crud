var E=Object.defineProperty;var k=(d,t,e)=>t in d?E(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var h=(d,t,e)=>k(d,typeof t!="symbol"?t+"":t,e);import{d as w,r as u,o as B,c as m,a as o,b as C,w as S,v as _,u as c,i as j,n as M,t as p,F as A,e as F,f as b}from"./index-CIW7kBmI.js";class O{constructor(t,e){h(this,"dbName");h(this,"storeName");this.dbName=t,this.storeName=e}initDB(){return new Promise((t,e)=>{const n=indexedDB.open(this.dbName,1);n.onupgradeneeded=s=>{const l=s.target.result;l.objectStoreNames.contains(this.storeName)||l.createObjectStore(this.storeName,{keyPath:"id",autoIncrement:!0})},n.onsuccess=()=>t(n.result),n.onerror=()=>e(n.error)})}async ftStore(){return(await this.initDB()).transaction(this.storeName,"readwrite").objectStore(this.storeName)}async addDataItem(t){(await this.ftStore()).add(t)}async remDataItem(t){(await this.ftStore()).delete(t)}async updDataItem(t){const e=await this.ftStore(),n=JSON.parse(JSON.stringify(t));e.put(n)}async getData(){const e=(await this.ftStore()).getAll();return new Promise(n=>{e.onsuccess=()=>n(e.result)})}}const P={class:"d-flex justify-content-center align-items-center vh-100"},T={class:"card p-5"},V={class:"mb-3"},q={class:"table table-bordered my-3"},z=["disabled","onClick"],G=["disabled","onClick"],L=w({__name:"IndexedDB",setup(d){let t=u([]),e=u(""),n=u(null),s=u(!1);const l=new O("MiBaseDeDatos","MiAlmacen");B(()=>{l.getData().then(r=>{t.value=r}).catch(r=>{console.error("Error al obtener los datos:",r)})});function f(){l.getData().then(r=>{t.value=r}).catch(r=>{console.error("Error al obtener los datos:",r)})}function D(){let r={nombre:e.value};if(e.value===""){alert("El campo no puede estar vacío");return}l.addDataItem(r).then(()=>{f()}).catch(a=>{console.error("Error al agregar el item:",a)}),e.value=""}function g(r){let a=t.value[r].id;a!==void 0?l.remDataItem(a).then(()=>{f()}).catch(i=>{console.error("Error al eliminar el item:",i)}):console.error("Error: El ID del item es undefined")}function I(r){e.value=t.value[r].nombre,n.value=r,s.value=!0}function y(){if(n.value!==null){let r=t.value[n.value].id;r!==void 0?l.updDataItem({nombre:e.value,id:r}).then(()=>{f()}).catch(a=>{console.error("Error al editar el item:",a)}):console.error("Error: El ID del item es undefined")}s.value=!1,n.value=null,e.value=""}function N(){s.value=!1,e.value=""}return(r,a)=>(b(),m("div",P,[o("div",null,[a[4]||(a[4]=o("h1",{class:"text-center"},"Bienvenido a la página IndexedDB",-1)),o("div",T,[o("div",V,[a[2]||(a[2]=o("label",{for:"inputTexto",class:"form-label"},"Ingrese un nombre",-1)),S(o("input",{"onUpdate:modelValue":a[0]||(a[0]=i=>j(e)?e.value=i:e=i),type:"text",class:"form-control",id:"inputTexto"},null,512),[[_,c(e)]])]),o("button",{onClick:a[1]||(a[1]=i=>c(s)?y():D()),class:M(["btn",c(s)?"btn-secondary":"btn-primary"])},p(c(s)?"Guardar":"Enviar"),3),c(s)?(b(),m("button",{key:0,onClick:N,class:"btn btn-danger my-1"},"Cancelar")):C("",!0)]),o("table",q,[a[3]||(a[3]=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Nombre"),o("th",{scope:"col"},"Funciones")])],-1)),o("tbody",null,[(b(!0),m(A,null,F(c(t),(i,v)=>(b(),m("tr",{key:v},[o("td",null,p(i.nombre)+" "+p(i.id),1),o("td",null,[o("button",{disabled:c(s),onClick:x=>I(v),class:"btn btn-success me-2"},"E",8,z),o("button",{disabled:c(s),onClick:x=>g(v),class:"btn btn-danger"},"X",8,G)])]))),128))])])])]))}});export{L as default};
